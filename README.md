# Module-Berserk

## TODO
- 피격 경직 처리
  - 강한 경직, 약한 경직 애니메이션 추가하기
  - 긴급 회피로 탈출
- 한 번의 공격에 여러 번 데미지를 입는 상황 방지하기
- 회피 (다크소울 구르기에 해당하는 액션)
- 더블 점프 사용 조건 결정되면 사용 제한 걸기 (ex. 연료/열기 사용)
- 아주 높은 곳에서 추락하는 상황에서 카메라 추적 좌표의 y값 조정하기
  - 지금은 땅에 닿을 때마다 y축 추적이 들어가서 플레이어가 시야 밖으로 나가는 상황도 가능함
  - 만약 맵의 수직 높이가 제한적이라면 지금 상태를 유지해도 상관 없음
- 상태이상, 무적, 슈퍼아머 등 관리하는 클래스 설계하기

## 리팩토링 후보
- PlayerManager
  - 맡은 역할이 워낙 많아서 적어도 공격 정도는 다른 곳으로 분리하게 될듯
- 피격 경직
  - 플레이어와 보스를 제외한 적 모두 경직 처리가 비슷할 것 같음
  - 각자 구현하는 대신 별개의 클래스로 분리해서 재사용하는 방식도 괜찮을 것 같음

## 코드로 드러나지 않는 중요한 사항
### 충돌 레이어 설정
#### 레이어 분류
- Character: 주인공 또는 적이 사용하는 레이어로 Character끼리는 충돌 x
- Weapon: 공격 범위로 사용하는 콜라이더에 할당되는 레이어. Weapon끼리는 충돌 x
- Interactable: 상호작용 가능한 물체에 할당되는 레이어. Character만 충돌 가능.
- Ground: 밟을 수 있는 지형지물에 할당되는 레이어.
#### 사용 예시
- 주인공 본체는 Character 레이어
- 적 본체에는 Character 레이어
- 적의 무기에는 Weapon 레이어
- 이렇게 하면 주인공과 적은 서로를 지나칠 수 있으면서도 무기에 의한 충돌 트리거는 정상 작동함
- 주인공 무기도 Weapon 레이어로 해야만 무기 공격 판정에 상호작용 가능한 물체가 반응하는 것을 예방할 수 있음
### OneWayPlatform 태그
- 아래 방향키를 두 번 빠르게 눌러 바닥으로 뚫고 들어가려면  
해당 플랫폼이 Ground 레이어이고 "OneWayPlatform"이라는 태그를 가져야 함.
### 공격 애니메이션들의 pivot은 중심으로 고정되지 않고 계속 변함!
- PlayerManager의 ApplyAttackRootMotion() 함수 참고 바람
- 원본 에셋 자체에 이동이 포함되어서 이를 스프라이트 상의 이동이 아니라  
rigidbody의 이동으로 변환하기 위해 꼼수를 조금 썼음
- 처음 보면 이게 뭐지 싶을 수 있으니 주석을 꼭 읽어주십쇼
- 이 방식을 계속 사용할거면 다음 요구조건을 만족해야 함
  1. 공격 애니메이션의 그림 자체에 이동이 포함될 것 (캐릭터가 이동하면 중심에서 벗어나야 함)
  2. 유니티에 에셋 임포트한 뒤 프레임 별로 pivot을 수동으로 중심에 맞춰줄 것
